<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mir: server_example_input_filter.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Mir
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">server_example_input_filter.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<p>Demonstrate adding a custom input filter to a server</p>
<div class="fragment"><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * Copyright Â© 2014 Canonical Ltd.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * This program is free software: you can redistribute it and/or modify it</span></div><div class="line"><span class="comment"> * under the terms of the GNU General Public License version 2 or 3,</span></div><div class="line"><span class="comment"> * as published by the Free Software Foundation.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * This program is distributed in the hope that it will be useful,</span></div><div class="line"><span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div><div class="line"><span class="comment"> * GNU General Public License for more details.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * You should have received a copy of the GNU General Public License</span></div><div class="line"><span class="comment"> * along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * Authored By: Alan Griffiths &lt;alan@octopull.co.uk&gt;</span></div><div class="line"><span class="comment"> */</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="server__example__input__filter_8h.html">server_example_input_filter.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;mir/server.h&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;mir/compositor/compositor.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="display_8h.html">mir/graphics/display.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="display__configuration_8h.html">mir/graphics/display_configuration.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;mir/input/composite_event_filter.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="option_8h.html">mir/options/option.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;linux/input.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">namespace </span><a class="code" href="namespacemir_1_1examples.html">me</a> = <a class="code" href="namespacemir_1_1examples.html">mir::examples</a>;</div><div class="line"><span class="keyword">namespace </span><a class="code" href="namespacemir_1_1compositor.html">mc</a> = <a class="code" href="namespacemir_1_1compositor.html">mir::compositor</a>;</div><div class="line"><span class="keyword">namespace </span><a class="code" href="namespacemir_1_1graphics.html">mg</a> = <a class="code" href="namespacemir_1_1graphics.html">mir::graphics</a>;</div><div class="line"><span class="keyword">namespace </span><a class="code" href="namespacemir_1_1input.html">mi</a> = <a class="code" href="namespacemir_1_1input.html">mir::input</a>;</div><div class="line"></div><div class="line"><span class="keyword">namespace</span></div><div class="line">{</div><div class="line"><span class="keywordtype">void</span> print_key_event(<a class="code" href="group__mir__toolkit.html#gac6ccf405835223213567284c5f60c894">MirInputEvent</a> <span class="keyword">const</span>* ev)</div><div class="line">{</div><div class="line">    <span class="keyword">auto</span> event_time = <a name="a0"></a><a class="code" href="group__mir__toolkit.html#ga87b11e58f9bfbc2d5db4f9ddbcbc561f">mir_input_event_get_event_time</a>(ev);</div><div class="line">    <span class="keyword">auto</span> kev = <a name="a1"></a><a class="code" href="group__mir__toolkit.html#gab256f7bfb7ba9e2fa5288ba9bea988f5">mir_input_event_get_keyboard_event</a>(ev);</div><div class="line">    <span class="keyword">auto</span> scan_code = <a name="a2"></a><a class="code" href="group__mir__toolkit.html#ga52256243683d653ceb6663a12684194f">mir_keyboard_event_scan_code</a>(kev);</div><div class="line">    <span class="keyword">auto</span> key_code = <a name="a3"></a><a class="code" href="group__mir__toolkit.html#ga187eece561fc380767228fdb0fff784f">mir_keyboard_event_key_code</a>(kev);</div><div class="line"></div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Handling key event (time, scancode, keycode): &quot;</span> &lt;&lt; event_time &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt;</div><div class="line">              scan_code &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; key_code &lt;&lt; std::endl;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> print_touch_event(<a class="code" href="group__mir__toolkit.html#gac6ccf405835223213567284c5f60c894">MirInputEvent</a> <span class="keyword">const</span>* ev)</div><div class="line">{</div><div class="line">    <span class="keyword">auto</span> event_time = <a class="code" href="group__mir__toolkit.html#ga87b11e58f9bfbc2d5db4f9ddbcbc561f">mir_input_event_get_event_time</a>(ev);</div><div class="line">    <span class="keyword">auto</span> tev = <a name="a4"></a><a class="code" href="group__mir__toolkit.html#ga95c7896b2b0e765993448d54b08cbd9e">mir_input_event_get_touch_event</a>(ev);</div><div class="line">    <span class="keyword">auto</span> tc = <a name="a5"></a><a class="code" href="group__mir__toolkit.html#ga14a975b596d33eec99060eebfbc07eae">mir_touch_event_point_count</a>(tev);</div><div class="line"></div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Handling touch event time=&quot;</span> &lt;&lt; event_time</div><div class="line">              &lt;&lt; <span class="stringliteral">&quot; touch_count=&quot;</span> &lt;&lt; tc &lt;&lt; std::endl;</div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; tc; i++)</div><div class="line">    {</div><div class="line">        <span class="keyword">auto</span> <span class="keywordtype">id</span> = <a name="a6"></a><a class="code" href="group__mir__toolkit.html#gad364eea5e42f5fac4d318ac150ee5e65">mir_touch_event_id</a>(tev, i);</div><div class="line">        <span class="keyword">auto</span> px = <a name="a7"></a><a class="code" href="group__mir__toolkit.html#ga4d102bd8d6f5e7d5a02402c9f37db160">mir_touch_event_axis_value</a>(tev, i, <a name="a8"></a><a class="code" href="group__mir__toolkit.html#ggacb5dd8de82dba71f2041147e03057dd1aad772235cc352aaea369cdcf6c20d365">mir_touch_axis_x</a>);</div><div class="line">        <span class="keyword">auto</span> py = <a class="code" href="group__mir__toolkit.html#ga4d102bd8d6f5e7d5a02402c9f37db160">mir_touch_event_axis_value</a>(tev, i, <a name="a9"></a><a class="code" href="group__mir__toolkit.html#ggacb5dd8de82dba71f2041147e03057dd1a0271484f1f09eb5130503a74ffe9940a">mir_touch_axis_y</a>);</div><div class="line"></div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;  &quot;</span></div><div class="line">            &lt;&lt; <span class="stringliteral">&quot; id=&quot;</span> &lt;&lt; <span class="keywordtype">id</span></div><div class="line">            &lt;&lt; <span class="stringliteral">&quot; pos=(&quot;</span> &lt;&lt; px &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; py &lt;&lt; <span class="stringliteral">&quot;)&quot;</span></div><div class="line">            &lt;&lt; std::endl;</div><div class="line">    }</div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;----------------&quot;</span> &lt;&lt; std::endl &lt;&lt; std::endl;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> print_pointer_event(<a class="code" href="group__mir__toolkit.html#gac6ccf405835223213567284c5f60c894">MirInputEvent</a> <span class="keyword">const</span>* ev)</div><div class="line">{</div><div class="line">    <span class="keyword">auto</span> event_time = <a class="code" href="group__mir__toolkit.html#ga87b11e58f9bfbc2d5db4f9ddbcbc561f">mir_input_event_get_event_time</a>(ev);</div><div class="line">    <span class="keyword">auto</span> pev = <a name="a10"></a><a class="code" href="group__mir__toolkit.html#ga8780ea75a8483e720b26544227c74996">mir_input_event_get_pointer_event</a>(ev);</div><div class="line">    <span class="keyword">auto</span> action = <a name="a11"></a><a class="code" href="group__mir__toolkit.html#gac2d84d19d8e4a16304b7848804d56582">mir_pointer_event_action</a>(pev);</div><div class="line"></div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Handling pointer event time=&quot;</span> &lt;&lt; event_time</div><div class="line">        &lt;&lt; <span class="stringliteral">&quot; action=&quot;</span>;</div><div class="line">    <span class="keywordflow">switch</span>(action)</div><div class="line">    {</div><div class="line">    <span class="keywordflow">case</span> <a name="a12"></a><a class="code" href="group__mir__toolkit.html#gga21471c2b2f03eb7e03907c5539ec4c2aa3e7860d6eb59246fe87c61626158cd32">mir_pointer_action_motion</a>:</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;motion&quot;</span>;</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">    <span class="keywordflow">case</span> <a name="a13"></a><a class="code" href="group__mir__toolkit.html#gga21471c2b2f03eb7e03907c5539ec4c2aac9818378b66e3dc884dac3c09eee0e00">mir_pointer_action_button_up</a>:</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;up&quot;</span>;</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">    <span class="keywordflow">case</span> <a name="a14"></a><a class="code" href="group__mir__toolkit.html#gga21471c2b2f03eb7e03907c5539ec4c2aabbe8c958da382309958ba42671239e8e">mir_pointer_action_button_down</a>:</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;down&quot;</span>;</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">    <span class="keywordflow">default</span>:</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">    }</div><div class="line"></div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;  &quot;</span></div><div class="line">              &lt;&lt; <span class="stringliteral">&quot; pos=(&quot;</span> &lt;&lt; <a name="a15"></a><a class="code" href="group__mir__toolkit.html#ga5cf0c078b6787d199a0c775fddac3dab">mir_pointer_event_axis_value</a>(pev, <a name="a16"></a><a class="code" href="group__mir__toolkit.html#ggae98f3e1892277e54e0b278283cf0bc4ca1b0b27a1ddbfaaef9936dd74750c7489">mir_pointer_axis_x</a>) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div><div class="line">              &lt;&lt; <a class="code" href="group__mir__toolkit.html#ga5cf0c078b6787d199a0c775fddac3dab">mir_pointer_event_axis_value</a>(pev, <a name="a17"></a><a class="code" href="group__mir__toolkit.html#ggae98f3e1892277e54e0b278283cf0bc4ca8c0cf060a6ca5c07ab39c76659f0b050">mir_pointer_axis_y</a>) &lt;&lt; <span class="stringliteral">&quot;)&quot;</span></div><div class="line">              &lt;&lt; <span class="stringliteral">&quot; relative=(&quot;</span> &lt;&lt; <a class="code" href="group__mir__toolkit.html#ga5cf0c078b6787d199a0c775fddac3dab">mir_pointer_event_axis_value</a>(pev, <a name="a18"></a><a class="code" href="group__mir__toolkit.html#ggae98f3e1892277e54e0b278283cf0bc4cab7271d2b61854105f292cc1e8947481a">mir_pointer_axis_relative_x</a>) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div><div class="line">              &lt;&lt; <a class="code" href="group__mir__toolkit.html#ga5cf0c078b6787d199a0c775fddac3dab">mir_pointer_event_axis_value</a>(pev, <a name="a19"></a><a class="code" href="group__mir__toolkit.html#ggae98f3e1892277e54e0b278283cf0bc4caa10f74c52a315d3890c97095709fffa3">mir_pointer_axis_relative_y</a>) &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;----------------&quot;</span> &lt;&lt; std::endl &lt;&lt; std::endl;</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">struct </span>PrintingEventFilter : <span class="keyword">public</span> mi::EventFilter</div><div class="line">{</div><div class="line">    <span class="keywordtype">bool</span> handle(<a class="code" href="group__mir__toolkit.html#gacf322761dc4f8106854e8eaa3f125e6f">MirEvent</a> <span class="keyword">const</span>&amp; ev)<span class="keyword"> override</span></div><div class="line"><span class="keyword">    </span>{</div><div class="line">        <span class="keywordflow">if</span> (<a name="a20"></a><a class="code" href="group__mir__toolkit.html#ga32dde1ebede4cee1cd059696019e1913">mir_event_get_type</a>(&amp;ev) != <a name="a21"></a><a class="code" href="group__mir__toolkit.html#gga712a4ef4fc23b2bddc5d7f7377ceaf4aac308c7583545f796a823accd2aef8184">mir_event_type_input</a>)</div><div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line">        <span class="keyword">auto</span> input_event = <a name="a22"></a><a class="code" href="group__mir__toolkit.html#ga0c876dfdffafd6ae1cd23d980d6c5530">mir_event_get_input_event</a>(&amp;ev);</div><div class="line"></div><div class="line">        <span class="keywordflow">switch</span> (<a name="a23"></a><a class="code" href="group__mir__toolkit.html#gac5ced30132952d26ab9710b2986737bf">mir_input_event_get_type</a>(input_event))</div><div class="line">        {</div><div class="line">        <span class="keywordflow">case</span> <a name="a24"></a><a class="code" href="group__mir__toolkit.html#gga334b6f462d981b32fd590be762a0ee58a88c9246772cc51cae9e5a216ac98b228">mir_input_event_type_key</a>:</div><div class="line">            print_key_event(input_event);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> <a name="a25"></a><a class="code" href="group__mir__toolkit.html#gga334b6f462d981b32fd590be762a0ee58a4742335b1dca0e4ad22009012283c92c">mir_input_event_type_touch</a>:</div><div class="line">            print_touch_event(input_event);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> <a name="a26"></a><a class="code" href="group__mir__toolkit.html#gga334b6f462d981b32fd590be762a0ee58a347ec64330a52cd198d8c7f3e74d9b9d">mir_input_event_type_pointer</a>:</div><div class="line">            print_pointer_event(input_event);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">default</span>:</div><div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;unkown input event type: &quot;</span> &lt;&lt; <a class="code" href="group__mir__toolkit.html#gac5ced30132952d26ab9710b2986737bf">mir_input_event_get_type</a>(input_event) &lt;&lt; std::endl;</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line">    }</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">struct </span>ScreenRotationFilter : <span class="keyword">public</span> mi::EventFilter</div><div class="line">{</div><div class="line">    <span class="keywordtype">bool</span> handle(<a class="code" href="group__mir__toolkit.html#gacf322761dc4f8106854e8eaa3f125e6f">MirEvent</a> <span class="keyword">const</span>&amp; event)<span class="keyword"> override</span></div><div class="line"><span class="keyword">    </span>{</div><div class="line">        <span class="keywordflow">if</span> (<a class="code" href="group__mir__toolkit.html#ga32dde1ebede4cee1cd059696019e1913">mir_event_get_type</a>(&amp;event) != <a class="code" href="group__mir__toolkit.html#gga712a4ef4fc23b2bddc5d7f7377ceaf4aac308c7583545f796a823accd2aef8184">mir_event_type_input</a>)</div><div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> <span class="keyword">const</span> input_event = <a class="code" href="group__mir__toolkit.html#ga0c876dfdffafd6ae1cd23d980d6c5530">mir_event_get_input_event</a>(&amp;event);</div><div class="line"></div><div class="line">        <span class="keywordflow">if</span> (<a class="code" href="group__mir__toolkit.html#gac5ced30132952d26ab9710b2986737bf">mir_input_event_get_type</a>(input_event) != <a class="code" href="group__mir__toolkit.html#gga334b6f462d981b32fd590be762a0ee58a88c9246772cc51cae9e5a216ac98b228">mir_input_event_type_key</a>)</div><div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"></div><div class="line">        <span class="keywordflow">return</span> handle_keyboard_event(<a class="code" href="group__mir__toolkit.html#gab256f7bfb7ba9e2fa5288ba9bea988f5">mir_input_event_get_keyboard_event</a>(input_event));</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordtype">bool</span> handle_keyboard_event(<a class="code" href="group__mir__toolkit.html#ga8ed96fc14f09e59eb1eb256c0c65330e">MirKeyboardEvent</a> <span class="keyword">const</span>* event)</div><div class="line">    {</div><div class="line">        <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> modifier_mask =</div><div class="line">            <a name="a27"></a><a class="code" href="group__mir__toolkit.html#ggaf187f39f830b8e179acfbc953f7df377a213764397f09e8a619755b9d455ab834">mir_input_event_modifier_alt</a> |</div><div class="line">            <a name="a28"></a><a class="code" href="group__mir__toolkit.html#ggaf187f39f830b8e179acfbc953f7df377a88e64140cb4543f8bdffcf9fb4a0a6d5">mir_input_event_modifier_shift</a> |</div><div class="line">            <a name="a29"></a><a class="code" href="group__mir__toolkit.html#ggaf187f39f830b8e179acfbc953f7df377ad01f81c2a64897066ae135f49dc6ce10">mir_input_event_modifier_sym</a> |</div><div class="line">            <a name="a30"></a><a class="code" href="group__mir__toolkit.html#ggaf187f39f830b8e179acfbc953f7df377a00796ac9db6d5cb5e61449e5f914679f">mir_input_event_modifier_ctrl</a> |</div><div class="line">            <a name="a31"></a><a class="code" href="group__mir__toolkit.html#ggaf187f39f830b8e179acfbc953f7df377a01388b671cc2a90b31bbf7af149923ad">mir_input_event_modifier_meta</a>;</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> <span class="keyword">const</span> action = <a name="a32"></a><a class="code" href="group__mir__toolkit.html#ga216985996513b09de8d62bfb67874176">mir_keyboard_event_action</a>(event);</div><div class="line">        <span class="keyword">auto</span> <span class="keyword">const</span> scan_code = <a class="code" href="group__mir__toolkit.html#ga52256243683d653ceb6663a12684194f">mir_keyboard_event_scan_code</a>(event);</div><div class="line">        <span class="keyword">auto</span> <span class="keyword">const</span> modifiers = <a name="a33"></a><a class="code" href="group__mir__toolkit.html#ga2cd3d56c2dae9e39981da9780249edd8">mir_keyboard_event_modifiers</a>(event) &amp; modifier_mask;</div><div class="line"></div><div class="line">        <span class="keywordflow">if</span> (action == <a name="a34"></a><a class="code" href="group__mir__toolkit.html#ggab61bfb7575c845b69bf2932c4c2ab495aaf1ba470e3ac9bb20fb35d6af0c8933e">mir_keyboard_action_down</a> &amp;&amp;</div><div class="line">            modifiers == (<a class="code" href="group__mir__toolkit.html#ggaf187f39f830b8e179acfbc953f7df377a213764397f09e8a619755b9d455ab834">mir_input_event_modifier_alt</a> | <a class="code" href="group__mir__toolkit.html#ggaf187f39f830b8e179acfbc953f7df377a00796ac9db6d5cb5e61449e5f914679f">mir_input_event_modifier_ctrl</a>))</div><div class="line">        {</div><div class="line">            <span class="keywordflow">switch</span> (scan_code)</div><div class="line">            {</div><div class="line">            <span class="keywordflow">case</span> KEY_UP:</div><div class="line">                apply_orientation(<a name="a35"></a><a class="code" href="group__mir__toolkit.html#gga215257e3ab146a11d4d6246946fb1343a0bd7055c8d98e16bc62b2490c1e50792">mir_orientation_normal</a>);</div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">            <span class="keywordflow">case</span> KEY_DOWN:</div><div class="line">                apply_orientation(<a name="a36"></a><a class="code" href="group__mir__toolkit.html#gga215257e3ab146a11d4d6246946fb1343a8457ed7fd9a7190aa2661438b6143904">mir_orientation_inverted</a>);</div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">            <span class="keywordflow">case</span> KEY_LEFT:</div><div class="line">                apply_orientation(<a name="a37"></a><a class="code" href="group__mir__toolkit.html#gga215257e3ab146a11d4d6246946fb1343a48e84488031abdb6fb1fd0ccccb32de1">mir_orientation_left</a>);</div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">            <span class="keywordflow">case</span> KEY_RIGHT:</div><div class="line">                apply_orientation(<a name="a38"></a><a class="code" href="group__mir__toolkit.html#gga215257e3ab146a11d4d6246946fb1343a07f5c811cc95174cd213522511885da3">mir_orientation_right</a>);</div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">            <span class="keywordflow">default</span>:</div><div class="line">                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line">            }</div><div class="line"></div><div class="line">            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordtype">void</span> apply_orientation(<a class="code" href="group__mir__toolkit.html#ga215257e3ab146a11d4d6246946fb1343">MirOrientation</a> orientation)</div><div class="line">    {</div><div class="line">        <span class="comment">// TODO This is too nuts &amp; bolts for the public API.</span></div><div class="line">        <span class="comment">// TODO There should be an interface onto MediatingDisplayChanger that</span></div><div class="line">        <span class="comment">// TODO provides equivalent functionality wrapped nicely</span></div><div class="line">        compositor-&gt;stop();</div><div class="line">        <span class="keyword">auto</span> conf = display-&gt;configuration();</div><div class="line"></div><div class="line">        conf-&gt;for_each_output([orientation](<a name="_a39"></a><a class="code" href="structmir_1_1graphics_1_1_user_display_configuration_output.html">mg::UserDisplayConfigurationOutput</a>&amp; output)</div><div class="line">            {</div><div class="line">                output.<a name="a40"></a><a class="code" href="structmir_1_1graphics_1_1_user_display_configuration_output.html#a9c98a92837e19bcdbca625f6ea716766">orientation</a> = orientation;</div><div class="line">            });</div><div class="line"></div><div class="line">        display-&gt;configure(*conf);</div><div class="line">        compositor-&gt;start();</div><div class="line">    }</div><div class="line"></div><div class="line">    std::shared_ptr&lt;mg::Display&gt; display;</div><div class="line">    std::shared_ptr&lt;mc::Compositor&gt; compositor;</div><div class="line">};</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">auto</span> <a name="a41"></a><a class="code" href="namespacemir_1_1examples.html#acae77ff5d35c658b9c994db2b64c3999">me::make_printing_input_filter_for</a>(mir::Server&amp; server)</div><div class="line">-&gt; std::shared_ptr&lt;mi::EventFilter&gt;</div><div class="line">{</div><div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> print_input_events = <span class="stringliteral">&quot;print-input-events&quot;</span>;</div><div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> print_input_events_descr = <span class="stringliteral">&quot;List input events on std::cout&quot;</span>;</div><div class="line"></div><div class="line">    server.add_configuration_option(print_input_events, print_input_events_descr, mir::OptionType::null);</div><div class="line"></div><div class="line">    <span class="keyword">auto</span> <span class="keyword">const</span> printing_filter = std::make_shared&lt;PrintingEventFilter&gt;();</div><div class="line"></div><div class="line">    server.add_init_callback([printing_filter, &amp;server]</div><div class="line">        {</div><div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> options = server.get_options();</div><div class="line">            <span class="keywordflow">if</span> (options-&gt;is_set(print_input_events))</div><div class="line">                server.the_composite_event_filter()-&gt;prepend(printing_filter);</div><div class="line">        });</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> printing_filter;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">auto</span> <a name="a42"></a><a class="code" href="namespacemir_1_1examples.html#a103c66da2f460d61e24f7dccc9717df6">me::make_screen_rotation_filter_for</a>(mir::Server&amp; server)</div><div class="line">-&gt; std::shared_ptr&lt;input::EventFilter&gt;</div><div class="line">{</div><div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> screen_rotation = <span class="stringliteral">&quot;screen-rotation&quot;</span>;</div><div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> screen_rotation_descr = <span class="stringliteral">&quot;Rotate screen on Ctrl-Alt-&lt;Arrow&gt;&quot;</span>;</div><div class="line"></div><div class="line">    server.add_configuration_option(screen_rotation, screen_rotation_descr, mir::OptionType::null);</div><div class="line"></div><div class="line">    <span class="keyword">auto</span> <span class="keyword">const</span> screen_rotation_filter = std::make_shared&lt;ScreenRotationFilter&gt;();</div><div class="line"></div><div class="line">    server.add_init_callback([screen_rotation_filter, &amp;server]</div><div class="line">        {</div><div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> options = server.get_options();</div><div class="line">            <span class="keywordflow">if</span> (options-&gt;is_set(screen_rotation))</div><div class="line">            {</div><div class="line">                screen_rotation_filter-&gt;display = server.the_display();</div><div class="line">                screen_rotation_filter-&gt;compositor = server.the_compositor();</div><div class="line">                server.the_composite_event_filter()-&gt;prepend(screen_rotation_filter);</div><div class="line">            }</div><div class="line">        });</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> screen_rotation_filter;</div><div class="line">}</div></div><!-- fragment --> </div><!-- contents -->
<hr>
<p align="center">Copyright &copy; 2012-2017
 Canonical Ltd. <br />
Generated on czw, 28 wrz 2017, 12:44:51 UTC
</p>
</body>
</html>
